# 얕은 복사와 깊은 복사

복사 시 값과 화살표의 차이를 알아두자

값은 복사해도 되고, 화살표는 복사해도 그대로임







```py
from copy import deepcopy

l = [[1, 2], [3, 4]]
l1 = l  # X copy
l2 = l[:]  # Shallow copy
l3 = deepcopy(l)  # Deep copy

l1[0][0] = 9
l2[0][1] = 99
l3[1][0] = 999

print(l1)
# >> [[9, 99], [3, 4]]
print(l2)
# >> [[9, 99], [3, 4]]
print(l3)
# >> [[1, 2], [999, 4]]
```
변수에 직접적으로 저장되는 건 값의 주소에 가깝다.

l에는 리스트의 주소인 A가 저장되어 있고, 실제로 리스트가 저장된 곳에는 [1, 2]가 저장된 주소 B와 [3, 4]가 저장된 주소 C가 [B, C] 처럼 들어있는 것.

- `l1 = l`: Copy 아님

    `l1`이라는 변수에 `l`에 써있는 id인 A를 그대로 저장함

    `l1`의 값을 바꾸면 `l`의 값도 같이 바뀐다.

- `l2 = l[:]`: Shallow copy

    새로운 주소 D를 만들고, 여기에 `l`에 저장된 리스트인 [B, C]를 그대로 가져온다.

    1차원 리스트에서는 이걸로 충분하고, 실제로 1차원에서 `l2`의 값을 바꾸면 `l`에 적용되지 않는다.

    2차원 이상 리스트에서는 B와 C가 그대로이므로 `l2`의 가장 안쪽 값을 바꾸면 `l`에 그대로 적용됨

- `l3 = deepcopy(l)`: Deep Copy

    아예 `l`의 모든 값을 가져다가 새로운 주소에 저장한다.

    여기서는 A, B, C 모두 사용하지 않음

    `l3`의 값을 아무리 바꿔도 `l`에는 전혀 영향을 미치지 못한다.

이걸 이해하기 쉬운 방법은 폴더와 바로가기, 파일의 관계를 생각하면 편하다.

- `l1`은 폴더의 바로가기를 만들어서 거기서 작업을 하는 것

- `l2`는 폴더 안 파일의 바로가기를 만들고, 새로운 폴더에 넣은 것

- `l3`은 폴더 채로 복사해서 새로 붙여넣은 것

각 리스트의 id를 뽑아보면 바로 알 수 있음

```py
for x in [l1, l2, l3]:
    print(x)
    print(id(x), id(l) == id(x))
    print(id(x[0]), id(l[0]) == id(x[0]))

"""
결과

l1
1903825120768 True
1903825122496 True

l2
1903825121920 False 
1903825122496 True

l3
1903825120448 False
1903825120640 False
"""
```
`l1`은 바깥과 안쪽 리스트 모두의 id가 `l`과 같음

`l2`는 바깥쪽 리스트의 id는 다르지만, 안쪽은 같다

`l3`은 모두 id가 다르다


---

# [코드 시각화](https://pythontutor.com/visualize.html#mode=edit)

실제로 데이터가 메모리에 어떻게 저장되는지 보기가 좋다
