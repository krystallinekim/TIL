# 뷰(View)

## 1. 뷰(View)

- 뷰는 테이블과 똑같은 모습을 하고 있는 가상의 테이블이다 -> 실제 데이터가 담겨 있지는 않다.
- 대신 테이블처럼 똑같이 쓸 수 있다. 인라인 뷰와 똑같음


## 2. 뷰의 생성

- 뷰를 생성할 때는 `CREATE VIEW` 구문을 사용한다.
  - `CREATE OR REPLACE`를 사용하면 기존에 이름이 겹치는 뷰를 덮어씌움


    ```sql
    CREATE [OR REPLACE] VIEW {뷰 이름}
    AS {서브쿼리}
    [WITH CHECK OPTION];
    ```

- `WITH CHECK OPTION`의 경우, 서브쿼리에 기술된 조건에 부합하지 않는 값으로 수정하는 경우 오류를 발생시킴
   - 없으면 수정할 경우 뷰에서 사라짐

## 3. 뷰의 수정

- 뷰를 수정할 때는 `ALTER VIEW` 구문을 사용한다.
    
    ```sql
    ALTER VIEW {뷰 이름} AS {서브 쿼리};
    ```
    

## 4. DML

- 뷰는 기본적으로 읽기 전용으로 많이 사용하지만, 뷰를 통해서 원본 테이블의 데이터를 수정할 수도 있다.

```sql
-- INSERT
INSERT INTO v_job VALUES ('J8', '계약직');

-- UPDATE
UPDATE v_job
SET job_name = '인턴'
WHERE job_code = 'J8';

-- DELETE
DELETE FROM v_job
WHERE job_code = 'J8';
```
- 다만 실제로는 이렇게 안씀
- 일반적으로, 민감한 데이터를 제외하고 뷰를 만들어서 보내주고, 읽기 권한만 주는 방식

### DML이 불가능한 경우

1. 뷰의 정의에 포함되지 않은 열을 조작하는 경우
   - 뷰를 만들 때 포함되지 않은 열은 실제로 존재하지 않아 참조가 불가능함

2. 산술연산으로 정의된 열을 조작하는 경우
   - 실제로 테이블에 존재하는 열이 아니라, 가상으로 존재하는 열이기 때문에 추가/수정/삭제가 불가능함
   - 그 열을 빼고 조작하는건 가능


## 4. 뷰의 삭제

- 뷰를 삭제할 때는 `DROP VIEW` 구문을 사용한다.